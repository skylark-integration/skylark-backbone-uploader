/**
 * skylark-backbone - A version of backbone that ported to running on skylarkjs.
 * @author 
 * @version v0.9.0
 * @link 
 * @license MIT
 */
!function(t,e){var n=e.define,i=e.require,s="function"==typeof n&&n.amd,r=!s&&"undefined"!=typeof exports;if(!s&&!n){var a={};n=e.define=function(t,e,n){"function"==typeof n?(a[t]={factory:n,deps:e.map(function(e){return function(t,e){if("."!==t[0])return t;var n=e.split("/"),i=t.split("/");n.pop();for(var s=0;s<i.length;s++)"."!=i[s]&&(".."==i[s]?n.pop():n.push(i[s]));return n.join("/")}(e,t)}),exports:null},i(t)):a[t]=n},i=e.require=function(t){if(!a.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var n=a[t];if(!n.exports){var s=[];n.deps.forEach(function(t){s.push(i(t))}),n.exports=n.factory.apply(e,s)}return n.exports}}if(!n)throw new Error("The module utility (ex: requirejs or skylark-utils) is not loaded!");if(function(t,e){t("skylark-backbone/backbone",["skylark-langx/skylark","skylark-fw-model","skylark-jquery"],function(t,e,n){var i=t.backbone={emulateHTTP:!1,emulateJSON:!1};return i.$=n,i.sync=function(t,n,s){return langx.defaults(s||(s={}),{emulateHTTP:i.emulateHTTP,emulateJSON:i.emulateJSON}),e.backends.ajaxSync.apply(this,[t,n,s])},i}),t("skylark-backbone/events",["skylark-langx/langx","./backbone"],function(t,e){var n=Array.prototype.slice,i={on:function(t,e,i){var s=function(){var i=n.call(arguments,1);"all"==t&&i.unshift(arguments[0].type),e.apply(this,i)};return s._=e,this.overrided(t,s,i)},once:function(t,e,n){return this.one(t,e,n)},bind:function(t,e,n){return this.on(t,e,n)},unbind:function(t,e,n){return this.off(t,e,n)},stopListening:function(t,e,n){return this.unlistenTo(t,e,n)}},s=t.Evented.inherit(i),r=s.prototype,a=e.Events={bind:r.bind,listenTo:r.listenTo,listenToOnce:r.listenToOnce,off:r.off,on:r.on,once:r.once,stopListening:r.stopListening,trigger:r.trigger,unbind:r.unbind,unlistenTo:r.unlistenTo};return t.extend(e,a),{EventExtends:i,BackboneEvented:s}}),t("skylark-backbone/helper",["skylark-langx/langx","skylark-underscore/underscore","./backbone"],function(t,e,n){var i=function(t,n){return e.isFunction(t)?t:e.isObject(t)&&!n._isModel(t)?s(t):e.isString(t)?function(e){return e.get(t)}:t},s=function(t){var n=e.matches(t);return function(t){return n(t.attributes)}},r=n.extend=function(t,n){t.constructor=this._constructor;var i=this.inherit(t);return e.extend(i,n),i};return{addUnderscoreMethods:function(t,n,s){e.each(n,function(n,r){e[r]&&(t.prototype[r]=function(t,n,s){switch(t){case 1:return function(){return e[n](this[s])};case 2:return function(t){return e[n](this[s],t)};case 3:return function(t,r){return e[n](this[s],i(t,this),r)};case 4:return function(t,r,a){return e[n](this[s],i(t,this),r,a)};default:return function(){var t=slice.call(arguments);return t.unshift(this[s]),e[n].apply(e,t)}}}(n,r,s))})},extend:r}}),t("skylark-backbone/Collection",["skylark-langx/langx","skylark-fw-model","./backbone","./events","./helper"],function(t,e,n,i,s){var r=n.Collection=e.Collection.inherit({_construct:function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,_.extend({silent:!0},e))},initialize:function(){},sync:function(){return n.sync.apply(this,arguments)}});r.partial(i.EventExtends),Object.defineProperty(r.prototype,"model",{get(){return this.entity},set(t){this.entity=t}}),Object.defineProperty(r.prototype,"models",{get(){return this.entities},set(t){this.entities=t}}),r.prototype.modelId=r.prototype.entityId,r.prototype._isModel=r.prototype._isEntity;return s.addUnderscoreMethods(r,{forEach:3,each:3,map:3,collect:3,reduce:0,foldl:0,inject:0,reduceRight:0,foldr:0,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3,findIndex:3,findLastIndex:3},"models"),r.extend=s.extend,r}),t("skylark-backbone/Model",["skylark-langx/langx","skylark-underscore/underscore","skylark-fw-model","./backbone","./events","./helper"],function(t,e,n,i,s,r){var a=i.Model=n.Entity.inherit({_construct:function(e,n){t.Stateful.prototype._construct.apply(this,arguments),this.initialize.apply(this,arguments)},initialize:function(){},escape:function(t){return e.escape(this.get(t))},matches:function(t){return!!e.iteratee(t,this)(this.attributes)},sync:function(){return i.sync.apply(this,arguments)}});return a.partial(s.EventExtends),a.extend=r.extend,a}),t("skylark-backbone/History",["skylark-langx/langx","skylark-underscore/underscore","./backbone","./events","./helper"],function(t,e,n,i,s){var r=n.History=i.BackboneEvented.inherit({_construct:function(){this.handlers=[],this.checkUrl=e.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)}}),a=/^[#\/]|\s+$/g,o=/^\/+|\/+$/g,h=/#.*$/;return r.started=!1,r.partial({interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(a,"")},start:function(t){if(r.started)throw new Error("Backbone.history has already been started");if(r.started=!0,this.options=e.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=!1!==this.options.hashChange,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(o,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var n=this.root.slice(0,-1)||"/";return this.location.replace(n+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var i=document.body,s=i.insertBefore(this.iframe,i.firstChild).contentWindow;s.document.open(),s.document.close(),s.location.hash="#"+this.fragment}var a=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};if(this._usePushState?a("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?a("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),!this.options.silent)return this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),r.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();if(e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment)return!1;this.iframe&&this.navigate(e),this.loadUrl()},loadUrl:function(t){return!!this.matchRoot()&&(t=this.fragment=this.getFragment(t),e.some(this.handlers,function(e){if(e.route.test(t))return e.callback(t),!0}))},navigate:function(t,e){if(!r.started)return!1;e&&!0!==e||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;""!==t&&"?"!==t.charAt(0)||(n=n.slice(0,-1)||"/");var i=n+t;if(t=this.decodeFragment(t.replace(h,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,i);else{if(!this._wantsHashChange)return this.location.assign(i);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var s=this.iframe.contentWindow;e.replace||(s.document.open(),s.document.close()),this._updateHash(s.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var i=t.href.replace(/(javascript:|#).*$/,"");t.replace(i+"#"+e)}else t.hash="#"+e}}),n.history=new r,r.extend=n.extend,r}),t("skylark-backbone/Router",["skylark-langx/langx","skylark-underscore/underscore","./backbone","./events","./helper"],function(t,e,n,i,s){var r=n.Router=i.BackboneEvented.inherit({_construct:function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)}}),a=/\((.*?)\)/g,o=/(\(\?)?:\w+/g,h=/\*\w+/g,u=/[\-{}\[\]+?.,\\\^$|#\s]/g;return r.partial({initialize:function(){},route:function(t,i,s){e.isRegExp(t)||(t=this._routeToRegExp(t)),e.isFunction(i)&&(s=i,i=""),s||(s=this[i]);var r=this;return n.history.route(t,function(e){var a=r._extractParameters(t,e);!1!==r.execute(s,a,i)&&(r.trigger.apply(r,["route:"+i].concat(a)),r.trigger("route",i,a),n.history.trigger("route",r,i,a))}),this},execute:function(t,e,n){t&&t.apply(this,e)},navigate:function(t,e){return n.history.navigate(t,e),this},_bindRoutes:function(){if(this.routes){this.routes=e.result(this,"routes");for(var t,n=e.keys(this.routes);null!=(t=n.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(u,"\\$&").replace(a,"(?:$1)?").replace(o,function(t,e){return e?t:"([^/?]+)"}).replace(h,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,n){var i=t.exec(n).slice(1);return e.map(i,function(t,e){return e===i.length-1?t||null:t?decodeURIComponent(t):null})}}),r.extend=s.extend,r}),t("skylark-backbone/View",["skylark-langx/langx","skylark-utils-dom/query","skylark-utils-dom/noder","skylark-utils-dom/plugins","skylark-underscore/underscore","./backbone","./events","./helper"],function(t,e,n,i,s,r,a,o){var h=r.View=i.Plugin.inherit({_construct:function(t){this.cid=s.uniqueId("view"),this.preinitialize.apply(this,arguments),s.extend(this,s.pick(t,c)),this._ensureElement(),this.initialize.apply(this,arguments)},tagName:"div",$:function(t){return this.$el.find(t)},preinitialize:function(){},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.unlistenTo(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=e(t),this.el=this.$el[0]},delegateEvents:function(e){if(e||(e=t.result(this,"events")),!e)return this;for(var n in this.undelegateEvents(),e){var i=e[n];if(t.isFunction(i)||(i=this[i]),i){var s=n.match(u);this.delegate(s[1],s[2],t.proxy(i,this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.uid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.uid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.uid,e,n),this},_createElement:function(t,e){return n.createElement(t,e)},_ensureElement:function(){if(this.el)this.setElement(t.result(this,"el"));else{var e=t.mixin({},t.result(this,"attributes"));this.id&&(e.id=t.result(this,"id")),this.className&&(e.class=t.result(this,"className")),this.setElement(this._createElement(t.result(this,"tagName"),e)),this._setAttributes(e)}},_setAttributes:function(t){this.$el.attr(t)}});h.partial(a.EventExtends);var u=/^(\S+)\s*(.*)$/,c=["model","collection","el","id","attributes","className","tagName","events"];return h.extend=o.extend,h}),t("skylark-backbone/main",["./backbone","./events","./Collection","./Model","./History","./Router","./View"],function(t){return t}),t("skylark-backbone",["skylark-backbone/main"],function(t){return t})}(n),!s){var o=i("skylark-langx/skylark");r?module.exports=o:e.skylarkjs=o}}(0,this);
//# sourceMappingURL=sourcemaps/skylark-backbone.js.map
