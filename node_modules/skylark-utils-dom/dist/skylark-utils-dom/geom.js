/**
 * skylark-utils-dom - An Elegant HTML5 DOM utility Library.
 * @author Hudaokeji Co.,Ltd
 * @version v0.9.0
 * @link www.skylarkjs.org
 * @license MIT
 */
define(["./dom","./langx","./noder","./styler"],function(t,i,e,o){var n,l=/^(?:body|html)$/i,h=i.toPixel,r=e.offsetParent;function f(){if(void 0!==n)return n;var t,i,l=e.createFragment("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>")[0],h=l.childNodes[0];return e.append(document.body,l),t=h.offsetWidth,o.css(l,"overflow","scroll"),t===(i=h.offsetWidth)&&(i=l[0].clientWidth),e.remove(l),n=t-i}function s(t){if(e.isWindow(t))return{left:0,top:0,right:0,bottom:0};var i=getComputedStyle(t);return{left:h(i.borderLeftWidth,t),top:h(i.borderTopWidth,t),right:h(i.borderRightWidth,t),bottom:h(i.borderBottomWidth,t)}}function d(t,i){if(void 0===i)return l.test(t.nodeName)?{top:0,left:0}:t.getBoundingClientRect();var e=r(t),o=d(e),n=a(t),h=s(e);return v(t,{top:i.top-o.top-n.top-h.top,left:i.left-o.left-n.left-h.left}),this}function c(t,i){return void 0===i?t.getBoundingClientRect():(d(t,i),x(t,i),this)}function g(t,i){if(void 0==i)return{width:t.clientWidth,height:t.clientHeight};var e="border-box"===o.css(t,"box-sizing"),n={width:i.width,height:i.height};if(e){var l=s(t);void 0!==n.width&&(n.width=n.width+l.left+l.right),void 0!==n.height&&(n.height=n.height+l.top+l.bottom)}else{var h=m(t);void 0!==n.width&&(n.width=n.width-h.left-h.right),void 0!==n.height&&(n.height=n.height-h.top-h.bottom)}return o.css(t,n),this}function p(t){var i=t.documentElement,e=t.body,o=Math.max,n=o(i.scrollWidth,e.scrollWidth),l=o(i.clientWidth,e.clientWidth),h=o(i.offsetWidth,e.offsetWidth),r=o(i.scrollHeight,e.scrollHeight),f=o(i.clientHeight,e.clientHeight),s=o(i.offsetHeight,e.offsetHeight);return{width:n<h?l:n,height:r<s?f:r}}function a(t){if(e.isWindow(t))return{left:0,top:0,right:0,bottom:0};var i=getComputedStyle(t);return{left:h(i.marginLeft),top:h(i.marginTop),right:h(i.marginRight),bottom:h(i.marginBottom)}}function u(t){var i=x(t),e=a(t);return{width:i.width+e.left+e.right,height:i.height+e.top+e.bottom}}function m(t){if(e.isWindow(t))return{left:0,top:0,right:0,bottom:0};var i=getComputedStyle(t);return{left:h(i.paddingLeft),top:h(i.paddingTop),right:h(i.paddingRight),bottom:h(i.paddingBottom)}}function w(t,i){if(void 0===i){var e=t.getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset}}var o=r(t),n=w(o),l=a(t),h=s(o);return v(t,{top:i.top-n.top-l.top-h.top,left:i.left-n.left-l.left-h.left}),this}function v(t,i){if(void 0==i){var e=r(t),n=d(t),l=d(e),h=(a(t),s(e));return{top:n.top-l.top-h.top,left:n.left-l.left-h.left}}var f={top:i.top,left:i.left};return"static"==o.css(t,"position")&&(f.position="relative"),o.css(t,f),this}function W(t,i){if(void 0===i){var e=r(t),o=c(t),n=d(e),l=(a(t),s(e));return{top:o.top-n.top-l.top,left:o.left-n.left-l.left,width:o.width,height:o.height}}return v(t,i),x(t,i),this}function b(t,i){var e="scrollLeft"in t;return void 0===i?e?t.scrollLeft:t.pageXOffset:(e?t.scrollLeft=i:t.scrollTo(i,t.scrollY),this)}function y(t,i){var e="scrollTop"in t;return void 0===i?e?t.scrollTop:t.pageYOffset:(e?t.scrollTop=i:t.scrollTo(t.scrollX,i),this)}function x(t,e){if(void 0==e)return i.isWindow(t)?{width:t.innerWidth,height:t.innerHeight}:i.isDocument(t)?p(document):{width:t.offsetWidth,height:t.offsetHeight};var n="border-box"===o.css(t,"box-sizing"),l={width:e.width,height:e.height};if(!n){var h=m(t),r=s(t);void 0!==l.width&&""!==l.width&&null!==l.width&&(l.width=l.width-h.left-h.right-r.left-r.right),void 0!==l.height&&""!==l.height&&null!==l.height&&(l.height=l.height-h.top-h.bottom-r.top-r.bottom)}return o.css(t,l),this}function H(){return H}return i.mixin(H,{borderExtents:s,boundingPosition:d,boundingRect:c,clientHeight:function(t,i){return void 0==i?g(t).height:g(t,{height:i})},clientSize:g,clientWidth:function(t,i){return void 0==i?g(t).width:(g(t,{width:i}),this)},contentRect:function(t){var i=g(t),e=m(t);return{left:e.left,top:e.top,width:i.width-e.left-e.right,height:i.height-e.top-e.bottom}},getDocumentSize:p,height:function(t,i){return void 0==i?x(t).height:(x(t,{height:i}),this)},marginExtents:a,marginRect:function(t){var i=W(t),e=a(t);return{left:i.left,top:i.top,width:i.width+e.left+e.right,height:i.height+e.top+e.bottom}},marginSize:u,offsetParent:r,paddingExtents:m,pagePosition:w,pageRect:function(t,i){if(void 0===i){var e=t.getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}}return w(t,i),x(t,i),this},relativePosition:v,relativeRect:W,scrollbarWidth:f,scrollIntoView:function(t,i){var e,o,n,l,h,r,f=t.parentNode,s=function(t,i){var e,o,n=t;for(e=o=0;n&&n!=i&&n.nodeType;)e+=n.offsetLeft||0,o+=n.offsetTop||0,n=n.offsetParent;return{x:e,y:o}}(t,f);return e=s.x,o=s.y,n=t.offsetWidth,l=t.offsetHeight,h=f.clientWidth,r=f.clientHeight,"end"==i?(e-=h-n,o-=r-l):"center"==i&&(e-=h/2-n/2,o-=r/2-l/2),f.scrollLeft=e,f.scrollTop=o,this},scrollLeft:b,scrollTop:y,size:x,width:function(t,i){return void 0==i?x(t).width:(x(t,{width:i}),this)}}),function(){var t=Math.max,n=Math.abs,l=/left|center|right/,h=/top|center|bottom/,r=/[\+\-]\d+(\.[\d]+)?%?/,s=/^\w+/,d=/%$/;function c(t,i,e){return[parseFloat(t[0])*(d.test(t[0])?i/100:1),parseFloat(t[1])*(d.test(t[1])?e/100:1)]}function g(t,i){return parseInt(o.css(t,i),10)||0}var p={fit:{left:function(i,e){var o,n=e.within,l=n.isWindow?n.scrollLeft:n.offset.left,h=n.width,r=i.left-e.collisionPosition.marginLeft,f=l-r,s=r+e.collisionWidth-h-l;e.collisionWidth>h?f>0&&s<=0?(o=i.left+f+e.collisionWidth-h-l,i.left+=f-o):i.left=s>0&&f<=0?l:f>s?l+h-e.collisionWidth:l:f>0?i.left+=f:s>0?i.left-=s:i.left=t(i.left-r,i.left)},top:function(i,e){var o,n=e.within,l=n.isWindow?n.scrollTop:n.offset.top,h=e.within.height,r=i.top-e.collisionPosition.marginTop,f=l-r,s=r+e.collisionHeight-h-l;e.collisionHeight>h?f>0&&s<=0?(o=i.top+f+e.collisionHeight-h-l,i.top+=f-o):i.top=s>0&&f<=0?l:f>s?l+h-e.collisionHeight:l:f>0?i.top+=f:s>0?i.top-=s:i.top=t(i.top-r,i.top)}},flip:{left:function(t,i){var e,o,l=i.within,h=l.offset.left+l.scrollLeft,r=l.width,f=l.isWindow?l.scrollLeft:l.offset.left,s=t.left-i.collisionPosition.marginLeft,d=s-f,c=s+i.collisionWidth-r-f,g="left"===i.my[0]?-i.elemWidth:"right"===i.my[0]?i.elemWidth:0,p="left"===i.at[0]?i.targetWidth:"right"===i.at[0]?-i.targetWidth:0,a=-2*i.offset[0];d<0?((e=t.left+g+p+a+i.collisionWidth-r-h)<0||e<n(d))&&(t.left+=g+p+a):c>0&&((o=t.left-i.collisionPosition.marginLeft+g+p+a-f)>0||n(o)<c)&&(t.left+=g+p+a)},top:function(t,i){var e,o,l=i.within,h=l.offset.top+l.scrollTop,r=l.height,f=l.isWindow?l.scrollTop:l.offset.top,s=t.top-i.collisionPosition.marginTop,d=s-f,c=s+i.collisionHeight-r-f,g="top"===i.my[1]?-i.elemHeight:"bottom"===i.my[1]?i.elemHeight:0,p="top"===i.at[1]?i.targetHeight:"bottom"===i.at[1]?-i.targetHeight:0,a=-2*i.offset[1];d<0?((o=t.top+g+p+a+i.collisionHeight-r-h)<0||o<n(d))&&(t.top+=g+p+a):c>0&&((e=t.top-i.collisionPosition.marginTop+g+p+a-f)>0||n(e)<c)&&(t.top+=g+p+a)}},flipfit:{left:function(){p.flip.left.apply(this,arguments),p.fit.left.apply(this,arguments)},top:function(){p.flip.top.apply(this,arguments),p.fit.top.apply(this,arguments)}}};H.posit=function(d,a){var m,v,W,H,T,L,z,P,R,B,C,D,O,S=(a=i.extend({},a)).of,M=(z=a.within,P=z||window,R=e.isWindow(P),B=!!P&&9===P.nodeType,C=!R&&!B,D=u(P),{element:P,isWindow:R,isDocument:B,offset:C?w(z):{left:0,top:0},scrollLeft:b(P),scrollTop:y(P),width:D.width,height:D.height}),X=function(t){var i=t.isWindow||t.isDocument?"":o.css(t.element,"overflow-x"),e=t.isWindow||t.isDocument?"":o.css(t.element,"overflow-y"),n="scroll"===i||"auto"===i&&t.width<scrollWidth(t.element);return{width:"scroll"===e||"auto"===e&&t.height<scrollHeight(t.element)?f():0,height:n?f():0}}(M),Y=(a.collision||"flip").split(" "),E={};return L=9===(O=S).nodeType?{size:x(O),offset:{top:0,left:0}}:e.isWindow(O)?{size:x(O),offset:{top:y(O),left:b(O)}}:O.preventDefault?{size:{width:0,height:0},offset:{top:O.pageY,left:O.pageX}}:{size:x(O),offset:w(O)},S.preventDefault&&(a.at="left top"),v=L.size.width,W=L.size.height,H=L.offset,T=i.extend({},H),i.each(["my","at"],function(){var t,i,e=(a[this]||"").split(" ");1===e.length&&(e=l.test(e[0])?e.concat(["center"]):h.test(e[0])?["center"].concat(e):["center","center"]),e[0]=l.test(e[0])?e[0]:"center",e[1]=h.test(e[1])?e[1]:"center",t=r.exec(e[0]),i=r.exec(e[1]),E[this]=[t?t[0]:0,i?i[0]:0],a[this]=[s.exec(e[0])[0],s.exec(e[1])[0]]}),1===Y.length&&(Y[1]=Y[0]),"right"===a.at[0]?T.left+=v:"center"===a.at[0]&&(T.left+=v/2),"bottom"===a.at[1]?T.top+=W:"center"===a.at[1]&&(T.top+=W/2),m=c(E.at,v,W),T.left+=m[0],T.top+=m[1],function(e){var o,l,h=u(e),r=h.width,f=h.height,s=g(e,"marginLeft"),d=g(e,"marginTop"),b=r+s+g(e,"marginRight")+X.width,y=f+d+g(e,"marginBottom")+X.height,x=i.extend({},T),L=c(E.my,h.width,h.height);"right"===a.my[0]?x.left-=r:"center"===a.my[0]&&(x.left-=r/2),"bottom"===a.my[1]?x.top-=f:"center"===a.my[1]&&(x.top-=f/2),x.left+=L[0],x.top+=L[1],o={marginLeft:s,marginTop:d},i.each(["left","top"],function(t,i){p[Y[t]]&&p[Y[t]][i](x,{targetWidth:v,targetHeight:W,elemWidth:r,elemHeight:f,collisionPosition:o,collisionWidth:b,collisionHeight:y,offset:[m[0]+L[0],m[1]+L[1]],my:a.my,at:a.at,within:M,elem:e})}),a.using&&(l=function(i){var o=H.left-x.left,l=o+v-r,h=H.top-x.top,s=h+W-f,d={target:{element:S,left:H.left,top:H.top,width:v,height:W},element:{element:e,left:x.left,top:x.top,width:r,height:f},horizontal:l<0?"left":o>0?"right":"center",vertical:s<0?"top":h>0?"bottom":"middle"};v<r&&n(o+l)<v&&(d.horizontal="center"),W<f&&n(h+s)<W&&(d.vertical="middle"),t(n(o),n(l))>t(n(h),n(s))?d.important="horizontal":d.important="vertical",a.using.call(this,i,d)}),w(e,i.extend(x,{using:l}))}(d)}}(),t.geom=H});
//# sourceMappingURL=sourcemaps/geom.js.map
