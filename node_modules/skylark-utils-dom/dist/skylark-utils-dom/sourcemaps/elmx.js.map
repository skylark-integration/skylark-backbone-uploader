{"version":3,"sources":["elmx.js"],"names":["define","dom","langx","datax","eventer","finder","fx","geom","noder","styler","$","map","Array","prototype","slice","VisualElement","klass","klassName","init","node","isString","document","getElementById","this","_elm","query","selector","root","body","elmx","mixin","batch","nodes","action","args","forEach","elm","apply","partial","name","fn","props","delegate","names","context","elem","ret","concat","call","arguments","HTMLElement","isArrayLike","el","_delegator","find","descendant","property","method","value","css","event","callback","on","toLowerCase"],"mappings":"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","file":"../elmx.js","sourcesContent":["define([\r\n    \"./dom\",\r\n    \"./langx\",\r\n    \"./datax\",\r\n    \"./eventer\",\r\n    \"./finder\",\r\n    \"./fx\",\r\n    \"./geom\",\r\n    \"./noder\",\r\n    \"./styler\",\r\n    \"./query\"\r\n], function(dom, langx, datax, eventer, finder, fx, geom, noder, styler,$) {\r\n    var map = Array.prototype.map,\r\n        slice = Array.prototype.slice;\r\n    /*\r\n     * VisualElement is a skylark class type wrapping a visule dom node,\r\n     * provides a number of prototype methods and supports chain calls.\r\n     */\r\n    var VisualElement = langx.klass({\r\n        klassName: \"VisualElement\",\r\n\r\n        \"init\": function(node) {\r\n            if (langx.isString(node)) {\r\n                node = document.getElementById(node);\r\n            }\r\n            this._elm = node;\r\n        }\r\n    });\r\n\r\n    VisualElement.prototype.$ = VisualElement.prototype.query = function(selector) {\r\n        return $(selector,this._elm);\r\n    };\r\n\r\n    /*\r\n     * the VisualElement object wrapping document.body\r\n     */\r\n    var root = new VisualElement(document.body),\r\n        elmx = function(node) {\r\n            if (node) {\r\n                return new VisualElement(node);\r\n            } else {\r\n                return root;\r\n            }\r\n        };\r\n    /*\r\n     * Extend VisualElement prototype with wrapping the specified methods.\r\n     * @param {ArrayLike} fn\r\n     * @param {Object} context\r\n     */\r\n    function _delegator(fn, context) {\r\n        return function() {\r\n            var self = this,\r\n                elem = self._elm,\r\n                ret = fn.apply(context, [elem].concat(slice.call(arguments)));\r\n\r\n            if (ret) {\r\n                if (ret === context) {\r\n                    return self;\r\n                } else {\r\n                    if (ret instanceof HTMLElement) {\r\n                        ret = new VisualElement(ret);\r\n                    } else if (langx.isArrayLike(ret)) {\r\n                        ret = map.call(ret, function(el) {\r\n                            if (el instanceof HTMLElement) {\r\n                                return new VisualElement(el);\r\n                            } else {\r\n                                return el;\r\n                            }\r\n                        })\r\n                    }\r\n                }\r\n            }\r\n            return ret;\r\n        };\r\n    }\r\n\r\n    langx.mixin(elmx, {\r\n        batch: function(nodes, action, args) {\r\n            nodes.forEach(function(node) {\r\n                var elm = (node instanceof VisualElement) ? node : elmx(node);\r\n                elm[action].apply(elm, args);\r\n            });\r\n\r\n            return this;\r\n        },\r\n\r\n        root: new VisualElement(document.body),\r\n\r\n        VisualElement: VisualElement,\r\n\r\n        partial: function(name, fn) {\r\n            var props = {};\r\n\r\n            props[name] = fn;\r\n\r\n            VisualElement.partial(props);\r\n        },\r\n\r\n        delegate: function(names, context) {\r\n            var props = {};\r\n\r\n            names.forEach(function(name) {\r\n                props[name] = _delegator(context[name], context);\r\n            });\r\n\r\n            VisualElement.partial(props);\r\n        }\r\n    });\r\n\r\n    // from ./datax\r\n    elmx.delegate([\r\n        \"attr\",\r\n        \"data\",\r\n        \"prop\",\r\n        \"removeAttr\",\r\n        \"removeData\",\r\n        \"text\",\r\n        \"val\"\r\n    ], datax);\r\n\r\n    // from ./eventer\r\n    elmx.delegate([\r\n        \"off\",\r\n        \"on\",\r\n        \"one\",\r\n        \"shortcuts\",\r\n        \"trigger\"\r\n    ], eventer);\r\n\r\n    // from ./finder\r\n    elmx.delegate([\r\n        \"ancestor\",\r\n        \"ancestors\",\r\n        \"children\",\r\n        \"descendant\",\r\n        \"find\",\r\n        \"findAll\",\r\n        \"firstChild\",\r\n        \"lastChild\",\r\n        \"matches\",\r\n        \"nextSibling\",\r\n        \"nextSiblings\",\r\n        \"parent\",\r\n        \"previousSibling\",\r\n        \"previousSiblings\",\r\n        \"siblings\"\r\n    ], finder);\r\n\r\n    /*\r\n     * find a dom element matched by the specified selector.\r\n     * @param {String} selector\r\n     */\r\n    elmx.find = function(selector) {\r\n        if (selector === \"body\") {\r\n            return this.root;\r\n        } else {\r\n            return this.root.descendant(selector);\r\n        }\r\n    };\r\n\r\n    // from ./fx\r\n    elmx.delegate([\r\n        \"animate\",\r\n        \"fadeIn\",\r\n        \"fadeOut\",\r\n        \"fadeTo\",\r\n        \"fadeToggle\",\r\n        \"hide\",\r\n        \"scrollToTop\",\r\n        \"show\",\r\n        \"toggle\"\r\n    ], fx);\r\n\r\n\r\n    // from ./geom\r\n    elmx.delegate([\r\n        \"borderExtents\",\r\n        \"boundingPosition\",\r\n        \"boundingRect\",\r\n        \"clientHeight\",\r\n        \"clientSize\",\r\n        \"clientWidth\",\r\n        \"contentRect\",\r\n        \"height\",\r\n        \"marginExtents\",\r\n        \"offsetParent\",\r\n        \"paddingExtents\",\r\n        \"pagePosition\",\r\n        \"pageRect\",\r\n        \"relativePosition\",\r\n        \"relativeRect\",\r\n        \"scrollIntoView\",\r\n        \"scrollLeft\",\r\n        \"scrollTop\",\r\n        \"size\",\r\n        \"width\"\r\n    ], geom);\r\n\r\n    // from ./noder\r\n    elmx.delegate([\r\n        \"after\",\r\n        \"append\",\r\n        \"before\",\r\n        \"clone\",\r\n        \"contains\",\r\n        \"contents\",\r\n        \"empty\",\r\n        \"html\",\r\n        \"isChildOf\",\r\n        \"ownerDoc\",\r\n        \"prepend\",\r\n        \"remove\",\r\n        \"removeChild\",\r\n        \"replace\",\r\n        \"reverse\",\r\n        \"throb\",\r\n        \"traverse\",\r\n        \"wrapper\",\r\n        \"wrapperInner\",\r\n        \"unwrap\"\r\n    ], noder);\r\n\r\n    // from ./styler\r\n    elmx.delegate([\r\n        \"addClass\",\r\n        \"className\",\r\n        \"css\",\r\n        \"hasClass\",\r\n        \"hide\",\r\n        \"isInvisible\",\r\n        \"removeClass\",\r\n        \"show\",\r\n        \"toggleClass\"\r\n    ], styler);\r\n\r\n    // properties\r\n\r\n    var properties = [ 'position', 'left', 'top', 'right', 'bottom', 'width', 'height', 'border', 'borderLeft',\r\n    'borderTop', 'borderRight', 'borderBottom', 'borderColor', 'display', 'overflow', 'margin', 'marginLeft', 'marginTop', 'marginRight', 'marginBottom', 'padding', 'paddingLeft', 'paddingTop', 'paddingRight', 'paddingBottom', 'color',\r\n    'background', 'backgroundColor', 'opacity', 'fontSize', 'fontWeight', 'textAlign', 'textDecoration', 'textTransform', 'cursor', 'zIndex' ];\r\n\r\n    properties.forEach( function ( property ) {\r\n\r\n        var method = property;\r\n\r\n        VisualElement.prototype[method ] = function (value) {\r\n\r\n            this.css( property, value );\r\n\r\n            return this;\r\n\r\n        };\r\n\r\n    });\r\n\r\n    // events\r\n    var events = [ 'keyUp', 'keyDown', 'mouseOver', 'mouseOut', 'click', 'dblClick', 'change' ];\r\n\r\n    events.forEach( function ( event ) {\r\n\r\n        var method = event;\r\n\r\n        VisualElement.prototype[method ] = function ( callback ) {\r\n\r\n            this.on( event.toLowerCase(), callback);\r\n\r\n            return this;\r\n        };\r\n\r\n    });\r\n\r\n\r\n    return dom.elmx = elmx;\r\n});"]}